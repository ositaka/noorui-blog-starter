---
id: "bidirectional-text-bidi"
title: "النص ثنائي الاتجاه وخوارزمية يونيكود BiDi"
excerpt: "تعلم كيف تتعامل أجهزة الكمبيوتر مع النص المختلط RTL و LTR باستخدام خوارزمية يونيكود ثنائية الاتجاه."
category: "rtl-ltr-concepts"
author: "karim-benali"
publishedAt: "2025-01-06"
readingTime: 13
featured: false
featuredImage: "https://jifbljttgucqvencyqhh.supabase.co/storage/v1/object/public/images/posts/bidirectional-text.jpg"
tags: ["bidi", "يونيكود", "rtl", "خوارزميات", "عرض-النص"]
---

## مقدمة

ماذا يحدث عندما يحتوي نص عربي على كلمات إنجليزية؟ أو عندما تتضمن جملة عبرية أرقاماً؟ عندما يظهر نص من اليسار إلى اليمين ونص من اليمين إلى اليسار معاً، تصبح الأمور معقدة بسرعة.

تأمل هذا النص المختلط:
```
The word "مرحبا" means hello.
```

الكلمة العربية "مرحبا" تحتاج أن تُعرض من اليمين إلى اليسار، بينما الإنجليزية المحيطة من اليسار إلى اليمين. كيف يعرف الكمبيوتر في أي اتجاه يجب أن يتدفق كل حرف؟

الجواب هو **خوارزمية يونيكود ثنائية الاتجاه** (BiDi) — مجموعة متطورة من القواعد التي تحكم كيفية عرض النص مختلط الاتجاه. فهم BiDi ضروري لأي مطور يعمل مع نص متعدد اللغات.

## ما هو النص ثنائي الاتجاه؟

### المشكلة

أنظمة الكتابة لها اتجاهات متأصلة مختلفة:
- **LTR (من اليسار إلى اليمين)**: اللاتينية، اليونانية، السيريلية، التايلاندية، إلخ.
- **RTL (من اليمين إلى اليسار)**: العربية، العبرية، السريانية، الثانا

عندما يظهر نص من أنظمة اتجاهية مختلفة معاً، يجب على محرك العرض تحديد:
١. الاتجاه العام للفقرة
٢. اتجاه كل جزء داخل الفقرة
٣. كيفية التعامل مع الحروف المحايدة (المسافات، علامات الترقيم، الأرقام)

### مثال بسيط

تأمل جملة عربية مع اسم علامة تجارية إنجليزية:

```
اتجاه أساسي من اليمين إلى اليسار:
← أنا أستخدم Microsoft Word يومياً ←
```

هذه الجملة يجب أن تُقرأ كـ:
١. "أنا أستخدم" - RTL
٢. "Microsoft Word" - LTR (مضمن)
٣. "يومياً" - RTL

التحدي هو عرض هذا بشكل صحيح مع الحفاظ على ترتيب الحروف المنطقي في الذاكرة.

## خوارزمية يونيكود ثنائية الاتجاه

### نظرة عامة

خوارزمية BiDi في يونيكود (UBA)، المحددة في **ملحق معيار يونيكود رقم ٩**، تحدد بالضبط كيفية تحديد وعرض اتجاه النص. إنها منفذة في كل متصفح حديث ونظام تشغيل ومحرك عرض نص.

### المفاهيم الأساسية

#### أنواع الحروف

كل حرف في يونيكود له خاصية **فئة ثنائية الاتجاه**. الفئات الرئيسية:

| الفئة | الاسم | أمثلة |
|-------|------|-------|
| L | من اليسار إلى اليمين | A-Z، الحروف اللاتينية |
| R | من اليمين إلى اليسار | الحروف العبرية |
| AL | حرف عربي | الحروف العربية |
| EN | رقم أوروبي | 0-9 |
| AN | رقم عربي | ٠-٩ |
| WS | مسافة بيضاء | المسافة |
| ON | محايد آخر | معظم علامات الترقيم |

#### مستويات التضمين

تعين الخوارزمية **مستوى تضمين** لكل حرف:
- المستويات الزوجية (٠، ٢، ٤...) = LTR
- المستويات الفردية (١، ٣، ٥...) = RTL

## التطبيقات العملية

### عناصر التحكم في HTML

استخدم هذه السمات والحروف:

```html
<!-- تعيين الاتجاه الأساسي -->
<p dir="rtl">فقرة عربية مع English here</p>

<!-- عزل النص المضمن -->
<p>الكلمة <bdi>hello</bdi> تعني مرحبا.</p>

<!-- تجاوز الخوارزمية -->
<span dir="ltr">فرض اتجاه LTR</span>
```

### حروف التحكم في يونيكود

أدخل هذه الحروف للتحكم في سلوك bidi:

```javascript
const LRM = '\u200E';  // علامة من اليسار إلى اليمين
const RLM = '\u200F';  // علامة من اليمين إلى اليسار
const LRI = '\u2066';  // عزل من اليسار إلى اليمين
const RLI = '\u2067';  // عزل من اليمين إلى اليسار
const FSI = '\u2068';  // عزل القوي الأول
const PDI = '\u2069';  // إنهاء العزل الاتجاهي

// مثال: ضمان الإنجليزية في سياق RTL
const text = `مرحباً ${LRI}Microsoft${PDI} العالم`;
```

### حالات الاستخدام الشائعة

#### إدراج نص LTR في سياق RTL

```html
<!-- اسم المنتج يجب أن يبقى LTR -->
<p dir="rtl">
  أنا أستخدم <span dir="ltr">iPhone 15 Pro</span> كل يوم
</p>
```

#### عناوين البريد الإلكتروني

عناوين البريد الإلكتروني يجب أن تكون دائماً LTR:
```html
<p dir="rtl">
  البريد الإلكتروني: <bdi dir="ltr">user@example.com</bdi>
</p>
```

## المزالق الشائعة

### مشاكل علامات الترقيم

علامات الترقيم "محايدة"، تأخذ اتجاهها من السياق:

```
المشكلة: "Hello, world" في سياق RTL
خطأ:   "Hello, world"  ← علامات الترقيم تتحرك
صحيح:  "Hello, world"  ← مع عزل مناسب
```

الحل: استخدم `<bdi>` أو عناصر تحكم العزل.

### الأرقام والرياضيات

الأرقام تُقرأ LTR حتى في نص RTL:
```
عربي: الرقم ٤٢ صحيح
ترتيب القراءة: من اليمين إلى اليسار، لكن ٤٢ يبقى "٤٢" وليس "٢٤"
```

## النقاط الرئيسية

١. **BiDi تلقائي لكنه غير مثالي**: خوارزمية BiDi في يونيكود تتعامل مع معظم الحالات لكنها تحتاج مساعدة في الحالات الحدية.

٢. **استخدم عناصر تحكم HTML**: سمة `dir` وعنصر `<bdi>` يوفران حلولاً دلالية وسهلة الوصول.

٣. **اعزل، لا تتجاوز**: `<bdi>` وعناصر تحكم العزل أكثر أماناً من التضمينات أو التجاوزات.

٤. **اختبر بمحتوى حقيقي**: الاختبارات الاصطناعية تفوت تعقيد العالم الحقيقي.

٥. **الحروف المحايدة تحتاج سياقاً**: علامات الترقيم والمسافات والأرقام تتصرف بناءً على اتجاه النص المحيط.

## للمزيد من القراءة

- [فهم اتجاه النص RTL](/ar/blog/understanding-rtl)
- [الأرقام في لغات RTL](/ar/blog/numbers-in-rtl-languages)
- [خصائص CSS المنطقية لدعم RTL/LTR](/ar/blog/css-logical-properties)
- [الأخطاء الشائعة في RTL وكيفية إصلاحها](/ar/blog/common-rtl-bugs)
